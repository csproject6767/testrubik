<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Rubik's Pro Terminal</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
<style>
:root { --neon:#00ff00; --bg:#000; }
* { box-sizing:border-box; }
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:#000;
  color:var(--neon);
  font-family:"Courier New",monospace;
  overflow:hidden;
}
/* overlay / onboarding */
#overlay{
  position:fixed;
  inset:0;
  z-index:10;
  background:#000;
  display:flex;
  justify-content:center;
  align-items:center;
}
.page{
  display:none;
  text-align:center;
  border:2px solid var(--neon);
  padding:40px;
  max-width:500px;
  background:#001100;
  box-shadow:0 0 30px rgba(0,255,0,0.3);
}
.page.active{display:block;}
.pop-btn{
  background:#000;
  border:2px solid var(--neon);
  color:var(--neon);
  padding:10px 20px;
  margin-top:15px;
  font-weight:bold;
  cursor:pointer;
  text-transform:uppercase;
}
.pop-btn:hover{
  background:var(--neon);
  color:#000;
  box-shadow:0 0 15px var(--neon);
}
.warning-red{
  color:#ff3333;
  border:1px solid #ff3333;
  padding:6px;
  margin:10px 0;
}
/* main layout */
#main-app{
  display:none;
  width:100vw;
  height:100vh;
  display:grid;
  grid-template-columns:280px 1fr;
}
/* sidebar */
#sidebar{
  background:rgba(0,10,0,0.95);
  border-right:1px solid var(--neon);
  padding:20px;
  display:flex;
  flex-direction:column;
}
.lesson-box{
  background:#002200;
  border:1px solid var(--neon);
  padding:12px;
  font-size:0.85rem;
  margin-bottom:20px;
}
/* cube + controls */
#cube-container{
  position:relative;
  width:100%;
  height:100%;
  padding:20px 40px 90px; /* bottom space for moves */
}
/* left: camera snap buttons */
.camera-column{
  position:absolute;
  top:50%;
  left:20px;
  transform:translateY(-50%);
  display:flex;
  flex-direction:column;
  gap:10px;
  z-index:5;
}
.camera-btn{
  width:50px;
  height:50px;
  border:2px solid var(--neon);
  background:#001100;
  color:var(--neon);
  font-size:1.2rem;
  cursor:pointer;
}
.camera-btn:hover{
  background:var(--neon);
  color:#000;
}
/* bottom: move buttons */
.move-bar{
  position:absolute;
  left:50%;
  bottom:70px;
  transform:translateX(-50%);
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  justify-content:center;
  z-index:5;
}
.move-btn{
  min-width:50px;
  height:40px;
  border:2px solid var(--neon);
  background:#001100;
  color:var(--neon);
  font-weight:bold;
  font-size:0.9rem;
  cursor:pointer;
}
.move-btn:hover{
  background:var(--neon);
  color:#000;
}
/* responsive */
@media (max-width:900px){
  #main-app{
    grid-template-columns:1fr;
    grid-template-rows:250px 1fr;
  }
  #cube-container{
    padding:10px 10px 90px;
  }
  .camera-column{
    position:absolute;
    top:10px;
    left:50%;
    transform:translateX(-50%);
    flex-direction:row;
  }
}
.milestone{ display:flex; align-items:flex-start; gap:12px; margin:15px 0; }
.circle-dot{ width:16px; height:16px; border-radius:50%; border:2px solid var(--neon); margin-top:6px; }
</style>
</head>
<body>
<!-- PAGES -->
<div id="overlay">
  <div id="p1" class="page active">
    <h1>Welcome to CubeZilla</h1>
    <p>Master the cube with interactive drills and step‑by‑step systems.</p>
    <p>Choose how you want to learn: play with the cube or follow a guided roadmap.</p>
    <button class="pop-btn" onclick="goPage('p-mode')">Continue</button>
  </div>
  <div id="p-mode" class="page">
    <h1>Choose Your Arena</h1>
    <p>Pick how you want to train today.</p>
    <button class="pop-btn" onclick="goPage('p-learn-or-play')"> Learn the Cube </button>
    <button class="pop-btn" onclick="initInteractiveCube()"> Interactive Cube Only </button>
  </div>
  <div id="p-learn-or-play" class="page">
    <h1>How Do You Want to Learn?</h1>
    <button class="pop-btn" onclick="goPage('p-coach')"> Guided Coach Mode </button>
    <button class="pop-btn" onclick="goPage('p-formulas')"> Formula Roadmap </button>
  </div>
  <div id="p-coach" class="page">
    <h1>Guided Coach Mode</h1>
    <p>Follow a human‑style walkthrough with tips, checks and slow motion demos.</p>
    <button class="pop-btn" onclick="startBeginnerCourse()"> Beginner Path (Layer by Layer) </button>
    <button class="pop-btn" onclick="startCreatorCourse()"> Creator's Path (Freestyle drills) </button>
    <button class="pop-btn" onclick="goPage('p-learn-or-play')"> ◀ Back </button>
  </div>
  <div id="p-formulas" class="page">
    <h1>Formula Roadmap</h1>
    <p>Pick your system and unlock milestones step by step.</p>
    <div style="margin-top:15px;">
      <button class="pop-btn" onclick="goPage('p-roadmap-beginner')"> Beginner System (White Cross → F2L → OLL → PLL) </button>
    </div>
    <div style="margin-top:10px;">
      <button class="pop-btn" onclick="goPage('p-roadmap-cfop')"> CFOP Track (Speedcubing) </button>
    </div>
    <div style="margin-top:10px;">
      <button class="pop-btn" onclick="goPage('p-roadmap-creator')"> Creator's Choice (Custom) </button>
    </div>
    <button class="pop-btn" onclick="goPage('p-learn-or-play')"> ◀ Back </button>
  </div>
  <div id="p-roadmap-beginner" class="page">
    <h1>Beginner Roadmap</h1>
    <p>Follow the milestones in order.</p>
    <!-- White Cross (no formulas, just instructions) -->
    <div class="milestone">
      <div class="circle-dot"></div>
      <div>
        <h3>Step 1: White Cross</h3>
        <p>No formulas. Learn intuitive moves to make + on the white face.</p>
        <button class="pop-btn" onclick="openWhiteCrossLesson()"> Start White Cross </button>
      </div>
    </div>
    <!-- F2L -->
    <div class="milestone">
      <div class="circle-dot"></div>
      <div>
        <h3>Step 2: F2L (First Two Layers)</h3>
        <p>Learn simple pair‑insertion cases, one at a time.</p>
        <button class="pop-btn" onclick="openF2LLesson()"> F2L Cases </button>
      </div>
    </div>
    <!-- OLL -->
    <div class="milestone">
      <div class="circle-dot"></div>
      <div>
        <h3>Step 3: OLL (Orient Last Layer)</h3>
        <p>Use a small set of starter algorithms to make the top color solid.</p>
        <button class="pop-btn" onclick="openOLLLesson()"> OLL Basics </button>
      </div>
    </div>
    <!-- PLL -->
    <div class="milestone">
      <div class="circle-dot"></div>
      <div>
        <h3>Step 4: PLL (Permute Last Layer)</h3>
        <p>Finish the cube with a small set of easy PLL cases.</p>
        <button class="pop-btn" onclick="openPLLLesson()"> PLL Basics </button>
      </div>
    </div>
    <button class="pop-btn" onclick="goPage('p-formulas')">◀ Back</button>
  </div>
  <div id="p-roadmap-cfop" class="page">
    <h1>CFOP Track</h1>
    <p>Follow the milestones in order.</p>
    <!-- Cross -->
    <div class="milestone">
      <div class="circle-dot"></div>
      <div>
        <h3>Step 1: Cross</h3>
        <p>Advanced cross techniques.</p>
        <button class="pop-btn" onclick="openCrossLesson()"> Start Cross </button>
      </div>
    </div>
    <!-- F2L Advanced -->
    <div class="milestone">
      <div class="circle-dot"></div>
      <div>
        <h3>Step 2: F2L Advanced</h3>
        <p>Full F2L algorithms for speed.</p>
        <button class="pop-btn" onclick="openAdvancedF2LLesson()"> Advanced F2L </button>
      </div>
    </div>
    <!-- 2-Look OLL -->
    <div class="milestone">
      <div class="circle-dot"></div>
      <div>
        <h3>Step 3: 2-Look OLL</h3>
        <p>Two-look orientation algorithms.</p>
        <button class="pop-btn" onclick="open2LookOLLLesson()"> 2-Look OLL </button>
      </div>
    </div>
    <!-- Full PLL -->
    <div class="milestone">
      <div class="circle-dot"></div>
      <div>
        <h3>Step 4: Full PLL</h3>
        <p>All PLL cases for speedcubing.</p>
        <button class="pop-btn" onclick="openFullPLLLesson()"> Full PLL </button>
      </div>
    </div>
    <button class="pop-btn" onclick="goPage('p-formulas')">◀ Back</button>
  </div>
  <div id="p-roadmap-creator" class="page">
    <h1>Creator's Choice</h1>
    <p>Follow the milestones in order.</p>
    <!-- Custom Alg Builder -->
    <div class="milestone">
      <div class="circle-dot"></div>
      <div>
        <h3>Step 1: Custom Alg Builder</h3>
        <p>Build your own algorithms.</p>
        <button class="pop-btn" onclick="openAlgBuilderLesson()"> Start Alg Builder </button>
      </div>
    </div>
    <!-- Drill Mode -->
    <div class="milestone">
      <div class="circle-dot"></div>
      <div>
        <h3>Step 2: Drill Mode</h3>
        <p>Practice custom drills.</p>
        <button class="pop-btn" onclick="openDrillModeLesson()"> Drill Mode </button>
      </div>
    </div>
    <button class="pop-btn" onclick="goPage('p-formulas')">◀ Back</button>
  </div>
  <div id="p-warn" class="page">
    <h1 style="color:#ff3333">⚠ BEWARE ⚠</h1>
    <div class="warning-red">Patience is required</div>
    <p>Mastering the cube takes hours of practice. Do not expect instant results.</p>
    <button class="pop-btn" onclick="goPage('p-method')">I have patience</button>
  </div>
  <div id="p-method" class="page">
    <h1>Select method</h1>
    <p><b>CFOP:</b> Fast, pro-level, hard to memorize.</p>
    <button class="pop-btn" onclick="initApp('CFOP')">Choose CFOP</button>
    <hr style="border-color:var(--neon)">
    <p><b>BEGINNER:</b> Simple layer-by-layer.</p>
    <button class="pop-btn" onclick="initApp('Beginner')">Choose Beginner</button>
  </div>
</div>
<!-- MAIN APP -->
<div id="main-app">
  <div id="sidebar">
    <h2 id="method-title">SYSTEM</h2>
    <div class="lesson-box">
      <h3>Lesson 1: Notations</h3>
      <p><b>F/R/B/L/U/D</b> = Snap + reorient cube.</p>
      <p><b>Buttons = screen‑relative</b> (R = screen‑right always).</p>
    </div>
    <button class="pop-btn" onclick="scramble()">Scramble</button>
    <button class="pop-btn" style="font-size:0.8rem" onclick="playDemo()">Demo: R</button>
    <button class="pop-btn" style="font-size:0.8rem" onclick="resetView()">Reset view</button>
  </div>
  <div id="cube-container">
    <!-- camera snap (view) -->
    <div class="camera-column">
      <button class="camera-btn" onclick="snapAndReorient('front')">F</button>
      <button class="camera-btn" onclick="snapAndReorient('right')">R</button>
      <button class="camera-btn" onclick="snapAndReorient('back')">B</button>
      <button class="camera-btn" onclick="snapAndReorient('left')">L</button>
      <button class="camera-btn" onclick="snapAndReorient('up')">U</button>
      <button class="camera-btn" onclick="snapAndReorient('down')">D</button>
    </div>
    <!-- MOVE BUTTONS -->
    <div style="position:absolute; left:50%; bottom:70px; transform:translateX(-50%); display:flex; flex-wrap:wrap; gap:8px; justify-content:center;">
      <button class="move-btn" onclick="screenMove('R')">R</button>
      <button class="move-btn" onclick="screenMove('R_prime')">R'</button>
      <button class="move-btn" onclick="screenMove('L')">L</button>
      <button class="move-btn" onclick="screenMove('L_prime')">L'</button>
      <button class="move-btn" onclick="screenMove('F')">F</button>
      <button class="move-btn" onclick="screenMove('F_prime')">F'</button>
      <button class="move-btn" onclick="screenMove('B')">B</button>
      <button class="move-btn" onclick="screenMove('B_prime')">B'</button>
      <button class="move-btn" onclick="screenMove('U')">U</button>
      <button class="move-btn" onclick="screenMove('U_prime')">U'</button>
      <button class="move-btn" onclick="screenMove('D')">D</button>
      <button class="move-btn" onclick="screenMove('D_prime')">D'</button>
    </div>
  </div>
</div>
<script>
let scene, camera, renderer;
let cubies = [];
let cubeGroup = new THREE.Group();
let isRotating = false;
let currentTargetFace = 'front';
let zoomDistance = 12; // starting distance from cube
const minZoom = 5;
const maxZoom = 25;

const standardViews = {
  front:{ cameraPos:[0,3,12], cubeRot:[0,0,0] },
  right:{ cameraPos:[12,3,0], cubeRot:[0,-Math.PI/2,0] },
  back: { cameraPos:[0,3,-12], cubeRot:[0,Math.PI,0] },
  left: { cameraPos:[-12,3,0], cubeRot:[0,Math.PI/2,0] },
  up: { cameraPos:[0,12,3], cubeRot:[-Math.PI/2,0,0] },
  down: { cameraPos:[0,-12,3], cubeRot:[Math.PI/2,0,0] }
};

/* pages */
function goPage(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}
function initApp(method){
  document.getElementById('overlay').style.display='none';
  document.getElementById('main-app').style.display='grid';
  document.getElementById('method-title').innerText = method + " HUB";
  setup3D();
}
function initInteractiveCube() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('main-app').style.display = 'grid';
  document.getElementById('method-title').innerText = "Interactive Cube";
  setup3D(); // same as now
}
function startBeginnerCourse() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('main-app').style.display = 'grid';
  document.getElementById('method-title').innerText = "Beginner Path";
  setup3D();
}
function startCreatorCourse() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('main-app').style.display = 'grid';
  document.getElementById('method-title').innerText = "Creator's Path";
  setup3D();
}
function openWhiteCrossLesson() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('main-app').style.display = 'grid';
  document.getElementById('method-title').innerText = "White Cross";
  setup3D();
}
function openF2LLesson() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('main-app').style.display = 'grid';
  document.getElementById('method-title').innerText = "F2L";
  setup3D();
}
function openOLLLesson() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('main-app').style.display = 'grid';
  document.getElementById('method-title').innerText = "OLL";
  setup3D();
}
function openPLLLesson() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('main-app').style.display = 'grid';
  document.getElementById('method-title').innerText = "PLL";
  setup3D();
}
function openCrossLesson() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('main-app').style.display = 'grid';
  document.getElementById('method-title').innerText = "Cross";
  setup3D();
}
function openAdvancedF2LLesson() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('main-app').style.display = 'grid';
  document.getElementById('method-title').innerText = "Advanced F2L";
  setup3D();
}
function open2LookOLLLesson() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('main-app').style.display = 'grid';
  document.getElementById('method-title').innerText = "2-Look OLL";
  setup3D();
}
function openFullPLLLesson() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('main-app').style.display = 'grid';
  document.getElementById('method-title').innerText = "Full PLL";
  setup3D();
}
function openAlgBuilderLesson() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('main-app').style.display = 'grid';
  document.getElementById('method-title').innerText = "Alg Builder";
  setup3D();
}
function openDrillModeLesson() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('main-app').style.display = 'grid';
  document.getElementById('method-title').innerText = "Drill Mode";
  setup3D();
}
/* 3D setup */
function setup3D(){
  const container = document.getElementById('cube-container');
  scene = new THREE.Scene();
  camera = new THREE.PerspectiveCamera(
    35,
    container.clientWidth/container.clientHeight,
    0.1,
    1000
  );
  renderer = new THREE.WebGLRenderer({antialias:true,alpha:true});
  renderer.setSize(container.clientWidth,container.clientHeight);
  container.appendChild(renderer.domElement);
  scene.add(new THREE.AmbientLight(0xffffff,0.7));
  const dl1 = new THREE.DirectionalLight(0xffffff,1);
  dl1.position.set(1,1,0.5); scene.add(dl1);
  const dl2 = new THREE.DirectionalLight(0xffffff,0.5);
  dl2.position.set(-1,-1,-0.5); scene.add(dl2);
  scene.add(cubeGroup);
  const colors = [0xff0000,0xffa500,0xffffff,0xffff00,0x00ff00,0x0000ff];
  for(let x=-1;x<=1;x++){
    for(let y=-1;y<=1;y++){
      for(let z=-1;z<=1;z++){
        if(x===0 && y===0 && z===0) continue;
        const materials = [
          new THREE.MeshLambertMaterial({color:colors[0]}),
          new THREE.MeshLambertMaterial({color:colors[1]}),
          new THREE.MeshLambertMaterial({color:colors[2]}),
          new THREE.MeshLambertMaterial({color:colors[3]}),
          new THREE.MeshLambertMaterial({color:colors[4]}),
          new THREE.MeshLambertMaterial({color:colors[5]})
        ];
        const cubie = new THREE.Mesh(
          new THREE.BoxGeometry(0.95,0.95,0.95),
          materials
        );
        cubie.position.set(x,y,z);
        cubies.push(cubie);
        cubeGroup.add(cubie);
      }
    }
  }
  snapAndReorient('front');
  window.addEventListener('resize',()=>{
    camera.aspect = container.clientWidth/container.clientHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(container.clientWidth,container.clientHeight);
  });
  container.addEventListener('wheel', onMouseWheel);
  animate();
}

/* snapping view */
function snapAndReorient(targetFace) {
  const view = standardViews[targetFace];
  gsap.to(camera.position, {
    x: view.cameraPos[0],
    y: view.cameraPos[1],
    z: view.cameraPos[2],
    duration: 0.8,
    ease: "power2.inOut"
  });
  const rot = new THREE.Euler(view.cubeRot[0], view.cubeRot[1], view.cubeRot[2]);
  gsap.to(cubeGroup.rotation, {
    x: rot.x,
    y: rot.y,
    z: rot.z,
    duration: 0.8,
    ease: "power2.inOut"
  });
  currentTargetFace = targetFace;
}

// Very simple: one move = one 1/4 turn of a fixed face
function screenMove(move) {
  if (isRotating) return;
  // move is one of: 'F','F_prime','R','R_prime','L','L_prime','U','U_prime','D','D_prime','B','B_prime'
  let axis, layerSign, prime = false;
  if (move.endsWith('_prime')) {
    prime = true;
    move = move.replace('_prime', '');
  }
  // WORLD-AXIS MAPPING (fixed cube):
  // x+: right, x-: left, y+: up, y-: down, z+: front, z-: back
  switch (move) {
    case 'R': axis = 'x'; layerSign = 1; break;
    case 'L': axis = 'x'; layerSign = -1; break;
    case 'U': axis = 'y'; layerSign = 1; break;
    case 'D': axis = 'y'; layerSign = -1; break;
    case 'F': axis = 'z'; layerSign = 1; break;
    case 'B': axis = 'z'; layerSign = -1; break;
    default: return;
  }
  handleMove(axis, layerSign, prime);
}

function handleMove(axis, layerSign, prime) {
  isRotating = true;
  const pivot = new THREE.Group();
  scene.add(pivot);
  const movingCubies = [];
  cubies.forEach(cubie => {
    const worldPos = new THREE.Vector3();
    cubie.getWorldPosition(worldPos);
    if (Math.round(worldPos[axis]) === layerSign) {
      pivot.attach(cubie);
      movingCubies.push(cubie);
    }
  });
  const angle = (prime ? 1 : -1) * Math.PI / 2;
  gsap.to(pivot.rotation, {
    [axis]: angle,
    duration: 0.25,
    ease: "power2.inOut",
    onComplete: () => {
      movingCubies.forEach(cubie => {
        cubeGroup.attach(cubie);
        const p = cubie.position;
        cubie.position.set(
          Math.round(p.x),
          Math.round(p.y),
          Math.round(p.z)
        );
      });
      scene.remove(pivot);
      isRotating = false;
    }
  });
}

function onMouseWheel(event) {
  event.preventDefault();
  const delta = event.deltaY;
  zoomDistance += delta * 0.01;
  zoomDistance = Math.min(maxZoom, Math.max(minZoom, zoomDistance));
  const dir = new THREE.Vector3();
  camera.getWorldDirection(dir);
  const center = new THREE.Vector3(0, 0, 0);
  const newPos = center.clone().add(dir.multiplyScalar(-zoomDistance));
  camera.position.copy(newPos);
}

function resetView(){ snapAndReorient('front'); }
function animate(){
  requestAnimationFrame(animate);
  camera.lookAt(0,0,0);
  renderer.render(scene,camera);
}
/* helper buttons */
function playDemo(){ screenMove('R'); }
function scramble(){
  let count = 0;
  const moves = ['R','R_prime','L','L_prime','F','F_prime','B','B_prime','U','U_prime','D','D_prime'];
  const interval = setInterval(()=>{
    if(isRotating) return;
    if(count>=20){ clearInterval(interval); return; }
    const m = moves[Math.floor(Math.random()*moves.length)];
    screenMove(m);
    count++;
  },250);
}
</script>
</body>
</html>
